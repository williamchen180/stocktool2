<!DOCTYPE html>
<title>US Stock</title>
<html lang="zh-Hant" >
	<meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
	<meta http-equiv="cache-control" content="no-cache">
	<script>
		function loadPreset() {
			var xhttp;
			if (window.XMLHttpRequest) {
				// code for modern browsers
				xhttp = new XMLHttpRequest();
			} else {
				// code for IE6, IE5
				xhttp = new ActiveXObject("Microsoft.XMLHTTP");
			}
			xhttp.onreadystatechange = function() {
				if (xhttp.readyState == 4 && xhttp.status == 200) {
					document.getElementById("favorite_list").innerHTML = xhttp.responseText;
					document.getElementById("debug").innerHTML = xhttp.responseText;
				}
			};
			xhttp.open("POST", "favlist.py", true);
			xhttp.setRequestHeader( "Content-type", "application/x-www-form-urlencoded");
			xhttp.send("get_list=1");
		}
		function myInit() {
			loadPreset()
		}
	</script>
	<body onload="myInit()">
		<style type="text/css">
			#main {
			padding: 5px;
			border-collapse: collapse; 
			border: 1px solid #000000;
			width: 100%;
			}
			#main td {
			border: 1px solid #000000;
			padding: 3px;
			font-size: .9em;
			}
			#main
			th {
			border: 1px solid #000000;
			background-color: #CCFFCC;
			}
		</style>
		<script src="sorttable.js" type="text/javascript"></script>
		<script>
			function load_preset() {
				document.getElementById("preset").value = "PFD AWF GOF GDF EHI FCO HHY HIX MCR PCN PFL PFN PHK PTY RCS WEA MMT FFC CGO ETO PFO CHI CLM LOR GGT UTG GOOD LTC O ORC OLP WPC HCP NNN SNH MNR MFA NYMT PSA UHT JNK SJNK HYG PHB YYY REM VIG VNQ PFF CEFL PCEF PGX SPFF AMLP AMJ MLPI MLPN AMU MLPA PFLT SBR CODI DPM NGLS TGP TOO AHGP ARLP APU BPL CLMT CPLP EEP ETP GLP HHS MMLP NS NSH OKE OKS PAA SPH Ston TCP TLP CTL FGP PNNT SFL SSI TDW TK WMB";
			
			}
			
			function clear_preset() {
				document.getElementById("preset").value = "";
			}
			
			function check() {
				for(i=1;i<38;i++) {
					document.getElementById(i).checked = true;
				}
			}
			
			function uncheck() {
				for(i=1;i<38;i++) {
					document.getElementById(i).checked = false;
				}
			}
		</script>
		<div align="center">
			<h1> 請輸入代號: (yahoo finance上所定義的代號)</h1>
			<form action="/cgiplot.py" method="get" target="_blank">
				<textarea id="preset" style="font-size: 16pt" name="textcontent" cols="60" rows="1" placeholder="請輸入代號"></textarea>
				<br>
				<input type="radio" name="country" value="None" checked/>None
				<input type="radio" name="country" value="UK"/>UK
				<input type="radio" name="country" value="Germany"/>Germany
				<input type="radio" name="country" value="Singapore"/>Singapore
				<input type="radio" name="country" value="Hong Kong"/>Hone Kong<br>
				<input type="submit" value="搜尋" style="font-size: 16pt"  />
			</form>
			<button onclick="load_preset()">PRESET</button>
			<button onclick="clear_preset()">CLEAR</button><br>
		</div>
		<hr>
		<hr>
		<div align="center">
			<h1>條件搜尋</h1>
		</div>
		<h2>國家：</h2>
		<button onclick="check()">全選</button>
		<button onclick="uncheck()">全不選</button>
		<form action="/select.py" target="_blank">
			<table style="width:100%">
				<tr>
					<td><input type="checkbox" id="1" name="country" value="Argentina">Argentina<br></td>
					<td><input type="checkbox" id="2" name="country" value="Australia">Australia<br></td>
					<td><input type="checkbox" id="3" name="country" value="Austria">Austria<br></td>
					<td><input type="checkbox" id="4" name="country" value="Belgium">Belgium<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="5" name="country" value="Brazil">Brazil<br></td>
					<td><input type="checkbox" id="6" name="country" value="Canada">Canada<br></td>
					<td><input type="checkbox" id="7" name="country" value="Denmark">Denmark<br></td>
					<td><input type="checkbox" id="8" name="country" value="Finland">Finland<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="9" name="country" value="France">France<br></td>
					<td><input type="checkbox" id="10" name="country" value="Germany">Germany<br></td>
					<td><input type="checkbox" id="11" name="country" value="Greece">Greece<br></td>
					<td><input type="checkbox" id="12" name="country" value="Hong Kong">Hong Kong<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="13" name="country" value="Iceland">Iceland<br></td>
					<td><input type="checkbox" id="14" name="country" value="India">India<br></td>
					<td><input type="checkbox" id="15" name="country" value="Indonesia">Indonesia<br></td>
					<td><input type="checkbox" id="16" name="country" value="International">International<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="17" name="country" value="Israel">Israel<br></td>
					<td><input type="checkbox" id="18" name="country" value="Italy">Italy<br></td>
					<td><input type="checkbox" id="19" name="country" value="Korea">Korea<br></td>
					<td><input type="checkbox" id="20" name="country" value="Latvia">Latvia<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="21" name="country" value="Lithuania">Lithuania<br></td>
					<td><input type="checkbox" id="22" name="country" value="Malaysia">Malaysia<br></td>
					<td><input type="checkbox" id="23" name="country" value="Mexico">Mexico<br></td>
					<td><input type="checkbox" id="24" name="country" value="Netherlands">Netherlands<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="25" name="country" value="New Zealand">New Zealand<br></td>
					<td><input type="checkbox" id="26" name="country" value="Norway">Norway<br></td>
					<td><input type="checkbox" id="27" name="country" value="Portugal">Portugal<br></td>
					<td><input type="checkbox" id="28" name="country" value="Qatar">Qatar<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="29" name="country" value="Singapore">Singapore<br></td>
					<td><input type="checkbox" id="30" name="country" value="South">South<br></td>
					<td><input type="checkbox" id="31" name="country" value="Spain">Spain<br></td>
					<td><input type="checkbox" id="32" name="country" value="Sweden">Sweden<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="33" name="country" value="Taiwan">Taiwan<br></td>
					<td><input type="checkbox" id="34" name="country" value="Thailand">Thailand<br></td>
					<td><input type="checkbox" id="35" name="country" value="Turkey">Turkey<br></td>
					<td><input type="checkbox" id="36" name="country" value="UK">UK<br></td>
				</tr>
				<tr>
					<td><input type="checkbox" id="37" name="country" value="USA" checked>USA<br></td>
					<td><input type="checkbox" id="38" name="country" value="Venezuela">Venezuela<br></td>
				</tr>
			</table>
			<table style="width:100%">
				<tr>
					<td>
						<h2>類型：</h2>
						<select name="kind">
							<option value="all" selected="selected">全選</option>
							<option value="Stock" >Stock</option>
							<option value="ETF">ETF</option>
						</select>
					</td>
					<td>
						<h2>報酬率：</h2>
						<select name="ROI">
							<option value="0"> 0% 以上</option>
							<option value="5"> 5% 以上</option>
							<option value="10">10% 以上</option>
							<option value="15" selected="selected">15% 以上</option>
							<option value="20">20% 以上</option>
							<option value="25">25% 以上</option>
							<option value="30">30% 以上</option>
						</select>
					</td>
					<td>
						<h2>年ROI：</h2>
						<select name="yearsROI">
							<option value="1">1年</option>
							<option value="2">2年</option>
							<option value="3">3年</option>
							<option value="4">4年</option>
							<option value="5" selected="selected">5年</option>
						</select>
					</td>
					<td>
						<h2>公司成立年數：</h2>
						<select name="yearCompany">
							<option value="1"> 1年以上</option>
							<option value="3"> 3年以上</option>
							<option value="4"> 5年以上</option>
							<option value="10" selected="selected">10年以上</option>
						</select>
					</td>
					<td>
						<h2>股價：</h2>
						<select name="price">
							<option value="0">不限</option>
							<option value="1" selected="selected">1.0以上</option>
							<option value="5">5.0以上</option>
							<option value="10">10.0以上</option>
						</select>
					</td>
					<td>
						<h2>年股利次數：</h2>
						<select name="dividends">
							<option value="0" selected="selected">不限</option>
							<option value="1" >1次</option>
							<option value="-1" >1次以上</option>
							<option value="3" >3次</option>
							<option value="-3" >3次以上</option>
							<option value="4" >4次</option>
							<option value="-4" >4次以上</option>
							<option value="6" >6次</option>
							<option value="-6" >6次以上</option>
							<option value="12" >12次</option>
							<option value="-12" >12次以上</option>
						</select>
					</td>
				</tr>
			</table>
			<td>
				<input type="submit" value="Submit">
		</form>
		<hr>
		<hr>
		<div align="center">
			<h1>觀察名單管理</h1>
		</div>
		<SCRIPT type="text/javascript">
			function addRow(tableID) {
			
				var table = document.getElementById(tableID);
			
				var rowCount = table.rows.length;
				var row = table.insertRow(rowCount);

				if (rowCount != 0)
					rowCount -= 1;

			
				var cell0 = row.insertCell(0);
				var element0 = document.createElement("input");
				element0.type = "checkbox";
				element0.name="chkbox" + rowCount;
				element0.id = "chkbox" + rowCount;
				cell0.appendChild(element0);
			
				var cell1 = row.insertCell(1);
				cell1.innerHTML = rowCount + 1;
			
				var cell2 = row.insertCell(2);
				var element2 = document.createElement("input");
				element2.type = "text";
				element2.name = "text" + rowCount;
				element2.id = "text" + rowCount; 
				cell2.appendChild(element2);
			
				var cell3 = row.insertCell(3);
				var element3 = document.createElement("input");
				element3.type = "date";
				element3.name = "date" + rowCount;
				element3.id = "date" + rowCount;
				cell3.appendChild(element3);

				var cell4 = row.insertCell(4);
				var element4 = document.createElement("input");
				element4.type = "text";
				element4.name = "memo" + rowCount;
				element4.id = "memo" + rowCount;
				cell4.appendChild(element4);
			}
			
			function deleteRow(tableID) {
				try {
					var table = document.getElementById(tableID);
					var rowCount = table.rows.length;
			
					for(var i=0; i<rowCount; i++) {
						var row = table.rows[i];
						var chkbox = row.cells[0].childNodes[0];
						if(null != chkbox && true == chkbox.checked) {
							table.deleteRow(i);
							rowCount--;
							i--;
						}
					}

					rowCount = table.rows.length;

					for (var i=1;i<rowCount; i++) {
						var row = table.rows[i];
						var chkbox = row.cells[0].childNodes[0];
						var cntbox = row.cells[1];
						var textbox = row.cells[2].childNodes[0];
						var datebox = row.cells[3].childNodes[0];
						var memobox = row.cells[4].childNodes[0];

						cntbox.innerHTML = i;

						textbox.name = "text" + (i-1);
						textbox.id = "text" + (i-1);

						datebox.name = "date" + (i-1);
						datebox.id = "date" + (i-1);
						
						memobox.name = "memo" + (i-1);
						memobox.id = "memo" + (i-1);
					}

				}catch(e) {
					alert(e);
				}
			}
			
			function save_watch(tableID) {
				try {
					var table = document.getElementById(tableID);
					var rowCount = table.rows.length;
			
					document.getElementById("result").innerHTML = "儲存中"; 
			
					ret = "rowCount=" + rowCount + "&";
					for(var i=0; i < rowCount; i++) {
						var ele1 = document.getElementById("text" + i);
						var ele2 = document.getElementById("date" + i);
						var ele3 = document.getElementById("memo" + i);

						if (ele1)
							ret += "text" + i + "=" + ele1.value + "&";
						if (ele2)
							ret += "date" + i + "=" + ele2.value + "&";
						if (ele3)
							ret += "memo" + i + "=" + ele3.value + "&";

					}
			
					if (ret != "") {
						var xhttp = new XMLHttpRequest();
						xhttp.onreadystatechange = function() {
							if (xhttp.readyState == 4 && xhttp.status == 200) {
								document.getElementById("result").innerHTML = "已儲存"; 
								document.getElementById("debug").innerHTML = xhttp.responseText; 
							}
						};
						xhttp.open("POST", "favlist.py", true);
						xhttp.setRequestHeader( "Content-type", "application/x-www-form-urlencoded");
						xhttp.send( "save_list=1&" + ret );
					}
				} catch(e) {
					alert(e);
				}	

				loadPreset();
			}

			function fav_onchange() {
				document.getElementById("result").innerHTML = "未儲存"; 
			}

			function flick_check(tableID) {
				var gchkbox = document.getElementById('flickchk');
				var table = document.getElementById(tableID);
				var rowCount = table.rows.length;
		
				for(var i=0; i<rowCount; i++) {
					var row = table.rows[i];
					var chkbox = row.cells[0].childNodes[0];
					chkbox.checked = gchkbox.checked;
				}
			}
		</SCRIPT>
		<input type="checkbox" id="flickchk" onchange="flick_check('dataTable')">
		<INPUT type="button" value="增加列" onclick="addRow('dataTable')" >
		<INPUT type="button" value="刪除列" onclick="deleteRow('dataTable')" >
		<form id="favorite_list">
			<TABLE id="dataTable" width="350px" border="1">
				<tr>
					<th>選取</th>
					<th>項次</th>
					<th>代號</th>
					<th>日期</th>
					<th>註解</th>
					<th>起始價格</th>
					<th>當前價格</th>
					<th>獲利</th>
					<th>百分比</th>
				</tr>
				<tr>
					<TD><INPUT type="checkbox" name="chk"></TD>
					<TD> 1 </TD>
					<TD><INPUT type="text" id="text0" name="text0" value="" onchange="fav_onchange()"/></TD>
					<TD><input type="date" id="date0" name="date0" value="" onchange="fav_onchange()"/> </TD>
					<TD><input type="text" id="memo0" name="memo0" value="" onchange="fav_onchange()"/></TD>
				</tr>
					
			</TABLE>

		</form>
		<button style="font-size: 16pt" onclick="save_watch('dataTable')">儲存</button>
		<br>
		<div id="result"><h2></h2></div><br>
		<br>
		<br>
		<hr>
		<textarea id="debug" name="textcontent" cols="200" rows="40" placeholder="除錯"></textarea>
	</body>
</html>

